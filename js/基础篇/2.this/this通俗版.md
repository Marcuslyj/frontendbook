# this

### 定义

this 是在运行时进行绑定的，并不是在编写时绑定，它的上下文取决于函数调用时的各种条件。

当一个函数被调用时，会创建一个活动记录（有时候也称为执行上下文）。这个记录会包含函数在哪里被调用（调用栈）、函数的调用方法、传入的参数等信息。this 就是记录的 其中一个属性，会在函数执行的过程中用到。



4种方式调用一个函数

- 作为一个函数(function)——skulk()，直接被调用。

  > 默认绑定，this指向全局对象。非严格模式：window，严格模式：undefined

- 作为一个方法(method)——ninja.skulk()，关联在一个对象上，实现面向对象编程。

  > 隐式绑定，该对象会成为函数的上下文


- 通过函数的apply或者call方法——skulk.apply(ninja)或者skulk.call(ninja)。

  > 显式绑定
  
- 作为一个构造函数(constructor)——new Ninja()，实例化一个新的对象。

  > 新创建的对象





```js
// 硬绑定，后面如何调用，this指向都不会改变
function bind(fn, obj) {
	return function() {
        return fn.apply( obj, arguments ); 
    }; 
}
```



另外：箭头函数

箭头函数没有单独的this值。箭头函数的this与声明所在的上下文的相同。





#### new 做了什么？

1. 创建（或者说构造）一个全新的对象。
2. 这个新对象会被执行 [[ 原型 ]] 连接。
3. 这个新对象会绑定到函数调用的 this。
4. 如果函数没有返回其他对象，那么 new 表达式中的函数调用会自动返回这个新对象。



#### 优先级

new > call、apply（显式绑定）> obj1.foo()（隐式绑定）> 默认绑定




























## 网页载入方面

缓存

减少请求数

减少请求资源体积

提升网络传输速率











#### 图片资源优化

- 不要在HTML里缩放图像

- 雪碧图

- 字体图标（体积比图片小，不失真）

- WebP

- 内联（减少请求，体积对比，http2不适用？）

  体积会更大，且不能被浏览器缓存，适用于小图片





## 页面渲染

- js放底部
- css方头部
- 避免css表达式
- 使用外部js和css（缓存）



## 网络

- #### 减少HTTP请求

  > 为什么要减少http请求

  - 图片相关
    - css sprites
    - 内联图片，base64（实际作用分析结果怎样？会导致构建包增大吧？而且不能缓存？）
  - 缓存

- #### 提升网络传输速率

  - cdn（基础库，基础业务包）

- #### 提前加载提前解析

  prefetch 、dns-prefetch

- #### 压缩（gzip）

- #### 缓存

  缓存可以减少请求数量和大小

  > 缓存都会使用dns吗？

  - expires头

    问题是C/S的时间差

  - cache-control(http1.1)

  - 使用外部js 、css，方便缓存

- #### 减少重定向

  > 为什么存在重定向？

  适当的重定向提供更好的功能

  1. 新（启用）旧（废弃）网站，将用户从久网站导向新网站。（301、302）
  2. 方便访问，例如[http://cnblogs.com](http://cnblogs.com/)和[http://www.cnblogs.com](http://www.cnblogs.com/)都能访问到，只是前者多一个重定向
  3. 提供个性化的本地服务，例如 bing.com重定向到cn.bing.com

  > 重定向有什么问题？

  1. 延迟html文档的传输，用户体验不好。
  2. 增加请求数。增加了浏览器到服务器的往返次数。

  > 怎么减少重定向？

  1.  定义链接地址时（href），使用完整、直达的地址

     如，

     使用[www.cnblogs.com](http://www.cnblogs.com/) 而不是[cnblogs.com](cnblogs.com)

     使用[www.mysite.com/products/](http://www.mysite.com/products/) 而不是 [www.mysite.com/products](http://www.mysite.com/products)（不带后缀时，浏览器尝试解析为文件夹）

  2. DNS中的[CNAME](http://en.wikipedia.org/wiki/CNAME_record)的机制来定义别名。

     A记录是解析域名到IP，CNAME是解析域名到另外一个域名。

  > 301 vs 302

  301跳转对查找引擎是一种对照驯良的跳转编制，也是查找引擎能够遭遇的跳转编制，它告诉查找引擎，这个地址弃用了，永远转向一个新地址，可以转移新域名的权重。而302重定向很容易被搜索引擎误认为是利用多个域名指向同一网站，那么你的网站就会被封掉，罪名是“利用重复的内容来干扰Google搜索结果的网站排名”。

  ##### 网址劫持

  从网站A（网站比较烂）上做了一个302跳转到网站B（搜索排名很靠前），这时候有时搜索引擎会使用网站B的内容，但却收录了网站A的地址，这样在不知不觉间，网站B在为网站A作贡献，网站A的排名就靠前了。

  由于搜索引擎排名算法只是程序而不是人，在遇到302 重定向的时候，并不能像人一样的去准确判定哪一个网址更适当，这就造成了网址[URL](http://baike.baidu.com/view/1496.htm) 劫持的可能性。

  一个不道德的人在他自己的网址A 做一个302 重定向到你的网址B，出于某种原因， Google 搜索结果所显示的仍然是网址A，但是所用的网页内容却是你的网址B 上的内容，这种情况就叫做网址URL 劫持。

- #### 减少DNS查找

  > DNS查找流程

  首先查看浏览器缓存是否存在，不存在则访问本机DNS缓存，再不存在则访问本地DNS服务器。所以DNS也是开销，通常浏览器查找一个给定URL的IP地址要花费20-120ms，在DNS查找完成前，浏览器不能从host那里下载任何东西。

  > TTL值

  TTL(Time-To-Live)，就是一条域名解析记录在DNS服务器中的存留时间。当各地的DNS服务器接受到解析请求时，就会向域名指定的NS服务器(权威域名服务器）发出解析请求从而获得解析记录；在获得这个记录之后，记录会在DNS服务器(各地的缓存服务器，也叫递归域名服务器）中保存一段时间，这段时间内如果再接到这个域名的解析请求，DNS服务器将不再向NS服务器发出请求，而是直接返回刚才获得的记录；而这个记录在DNS服务器上保留的时间，就是TTL值。

  > 影响因素

  - 服务器可以设置TTL值表示DNS记录的存活时间。本机DNS缓存将根据这个TTL值判断DNS记录什么时候被抛弃，这个TTL值一般都不会设置很大，主要是考虑到快速故障转移的问题。
  - 浏览器DNS缓存也有自己的过期时间，这个时间是独立于本机DNS缓存的，相对也比较短，例如chrome只有1分钟左右。
  - 浏览器DNS记录的数量也有限制，如果短时间内访问了大量不同域名的网站，则较早的DNS记录将被抛弃，必须重新查找。不过即使浏览器丢弃了DNS记录，操作系统的DNS缓存也有很大机率保留着该记录，这样可以避免通过网络查询而带来的延迟。

  > 如何减少DNS查找

  - DNS查找可以被缓存起来以提高性能。（怎么缓存？）
  - 使用Keep-Alive
  - 较少的域名（减少域名会潜在地减少页面中并行下载的数量，可能会增加响应时间）

  





## 打包优化

- #### 减少请求资源体积
  - js压缩（常规空格空行压缩，**gzip**，去除dead code）
  - HTML压缩
  - css （提取，压缩，去掉无用css）
  - 提取公共资源（js复用）

  














## 延迟渲染

通常为了加快页面渲染的速度， 基础的解决思路是，通过去除页面上除首屏以外的对于用 户不可见的信息区块，让页面的 DOM 节点数更少、 DOM 树结构更简单 ，从而达到加快页面下载和渲染速度的目的。

然后使用懒加载异步化请求、 BigPipe 等方案，动态加载这些不可见的信息区块。



挑战

展示结果的切分

我们都知道，在服务端数据查询请 的优化中，强调的是对于查询请求资源次数的优化，而不是查询结果的大小 。在这样的请求中， 查询结果一次返回 3条数据还是 50 条数据，所消耗的时间几乎是一样的。表面上页面通过这样的分割，可以达到减少 DOM 节点数、简化 DOM 树结构的目的， 但考虑到服务端所付出的代价，这无疑是得不偿失的。



测试

- 绘制render树： 隐藏节点，效果不明显；
- 构建render树：减少css知道没有，start render时间大幅提前。可知，基于dom树和样式构建render树耗时长，但是css精简有限。
- dom树：逐渐减少dom节点，效果明显



总结

渲染过程中，主要消耗在dom树和render树构建上

方案

在考虑尽量不修改服务端逻辑的前提下（保障可维护性），笔者最终选择使用 TextArea来存放首屏以下的 33 个搜索结果对应的 HTML 代码。 存放在TextArea 中的 HTML 代码，浏览器会解析识别为 TextArea内容，而不会被当作 DOM 节点进行解析。 所以通过这个办法，页面首次渲染的 DOM 树包含的节点节点数大幅减少，从而大幅提高首次渲染速度。





## SEO Ajax

问题

- 针对爬虫爬取收录的页面，页面内容必须同步展示。
- HTML 代码和实际展现的内容要保证一定程度的一致性，否则有被认作作弊页面的风险。



方案

Google 官方提供了一个称为 Ajax crawlable scheme Ajax 爬行方案。





















